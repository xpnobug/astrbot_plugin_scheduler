name: "通用定时任务调度器"
description: "功能强大的通用定时任务调度插件，支持Cron表达式、间隔执行、条件执行等多种调度方式。提供可视化配置界面和任务创建向导。"
version: "1.0.0"
author: "Couei"
repo: "https://github.com/xpnobug/astrbot_plugin_scheduler.git"
tags:
  - "任务调度"
  - "定时任务"
  - "自动化"
  - "Cron"
  - "调度器"

# 插件类型
type: "utility"

# 支持的平台
platforms:
  - "all"

# 依赖
dependencies:
  python:
    - "aiohttp>=3.8.0"  # 用于HTTP请求
  system: []

# 配置schema
config_schema:
  type: "object"
  properties:
    max_concurrent_tasks:
      type: "integer"
      default: 10
      description: "最大并发任务数"
    task_timeout:
      type: "integer" 
      default: 300
      description: "任务超时时间(秒)"
    log_retention_days:
      type: "integer"
      default: 30
      description: "日志保留天数"
    enable_task_history:
      type: "boolean"
      default: true
      description: "是否启用任务历史记录"
    notification_on_failure:
      type: "boolean"
      default: true
      description: "任务失败时是否发送通知"
    admin_user_id:
      type: "string"
      default: "admin"
      description: "管理员用户ID"

# 权限要求
permissions:
  - "file_system"      # 文件操作权限
  - "network"          # 网络访问权限
  - "message_send"     # 发送消息权限
  - "schedule"         # 定时任务权限

# 命令列表
commands:
  - command: "/task list [group]"
    description: "列出所有定时任务"
    permission: "user"
  - command: "/task info <task_id>"
    description: "查看任务详细信息"
    permission: "user"
  - command: "/task create"
    description: "🆕 可视化创建任务向导"
    permission: "admin"
  - command: "/task edit <task_id>"
    description: "🆕 可视化编辑任务"
    permission: "admin"
  - command: "/task delete <task_id>"
    description: "🆕 安全删除任务"
    permission: "admin"
  - command: "/task run <task_id>"
    description: "手动执行指定任务"
    permission: "admin"
  - command: "/task enable <task_id>"
    description: "启用指定任务"
    permission: "admin"
  - command: "/task disable <task_id>"
    description: "禁用指定任务"
    permission: "admin"
  - command: "/task status"
    description: "查看调度器运行状态"
    permission: "user"
  - command: "/task help"
    description: "显示帮助信息"
    permission: "user"

# 功能特性
features:
  - "🎯 可视化配置: 全新的交互式任务创建向导，无需编辑JSON文件"
  - "🕐 多种调度方式: 支持Cron表达式、固定间隔、一次性任务、手动触发"
  - "⚙️ 完全可配置: 支持可视化配置和JSON配置两种方式"
  - "🔧 丰富动作类型: 发送消息、API调用、文件操作、系统命令执行"
  - "🎯 条件执行: 支持复杂的执行条件和任务依赖关系"
  - "📝 变量模板: 动态变量替换，如{{timestamp}}、{{date}}等"
  - "🔄 错误处理: 自动重试机制、失败处理、异常恢复"
  - "📊 统计监控: 任务执行统计、成功率监控、历史记录"
  - "🏷️ 任务分组: 支持任务分组管理和批量操作"
  - "⏰ 时区支持: 支持不同时区的任务调度"
  - "🛡️ 安全保护: 命令执行安全检查，防止恶意操作"
  - "🔒 安全删除: 需要输入DELETE确认，防止误删除重要任务"

# 使用场景
use_cases:
  - "📅 定时提醒: 每日签到提醒、会议通知、生日提醒等"
  - "📰 内容推送: 定时推送新闻、天气、股票等信息"
  - "🔧 系统维护: 定时备份、日志清理、健康检查等"
  - "📊 数据采集: 定时调用API获取数据、生成报告等"
  - "🏃 自动化流程: 复杂的多步骤自动化任务执行"

# 配置文件说明
config_files:
  - path: "config/tasks.json"
    description: "示例任务配置文件，包含各种类型的任务示例"
    required: false
  - path: "data/scheduler/tasks.json"
    description: "用户实际任务配置文件，插件运行时会自动创建"
    required: false

# 安装说明
installation:
  notes:
    - "插件首次启动时会自动创建必要的目录和配置文件"
    - "如需自定义任务，请编辑 data/scheduler/tasks.json 文件"
    - "配置文件格式请参考 config/tasks.json 中的示例"
    - "建议定期备份任务配置文件"

# 更新日志
changelog:
  "1.0.0":
    - "初始版本发布"
    - "支持Cron表达式、间隔执行、一次性任务"
    - "实现消息发送、API调用、文件操作、命令执行等动作类型"
    - "提供完整的任务管理命令接口"
    - "支持条件执行和变量模板"
    - "包含错误处理和重试机制"

# 兼容性
compatibility:
  astrbot_version: ">=2.0.0"
  python_version: ">=3.8"

# 许可证
license: "MIT"

# 注意事项
warnings:
  - "⚠️ 执行系统命令有安全风险，请谨慎配置command类型的任务"
  - "⚠️ 请不要在生产环境中启用不安全的命令执行"
  - "⚠️ 建议定期检查任务执行日志，及时发现异常"
  - "⚠️ 大量并发任务可能影响系统性能，请合理设置任务数量"